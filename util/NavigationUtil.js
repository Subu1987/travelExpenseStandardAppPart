/*
 * Copyright (C) 2009-2022 SAP SE or an SAP affiliate company. All rights reserved.
 */
sap.ui.define(["sap/fin/travel/lib/reuse/util/FCLayoutUtil","sap/ui/core/routing/HashChanger","sap/fin/travel/lib/reuse/util/Utils"],function(F,H,U){"use strict";function g(){function I(p){var c=H.getInstance().getHash();if(c===p){return;}var D=p.match(/Tripno='(\d+)'/)&&p.match(/Tripno='(\d+)'/)[1];if("0000000000"===D){H.getInstance().replaceHash(p);}else{H.getInstance().setHash(p);}}function _(p,s){var c=[];s=s.substring(1);if(p){var P=p.split("/");for(var i=0;i<P.length;i++){if(P[i]!==""){if(s.split("(")[0]===P[i].split("(")[0]){c.push(s);return"/"+c.join("/");}else{c.push(P[i]);}}}c.push(s);return"/"+c.join("/");}return"/"+s;};function a(r){var R;if(r){var B,o;if(r.hasOwnProperty("__batchResponses")){B=r.__batchResponses[0];if(B&&B.__changeResponses[0]){R=B.__changeResponses[0].body;if(R){var o=JSON.parse(R);if(o&&o.d&&o.d.__metadata){var s=o.d.__metadata.type.split(".").shift();return o.d.__metadata.uri.split(s).pop();}}}}else if(r.hasOwnProperty("data")){if(r.data.hasOwnProperty("__batchResponses")){B=r.data.__batchResponses[0];if(B&&B.__changeResponses[0]){R=B.__changeResponses[0].body;if(R){var o=JSON.parse(R);if(o&&o.d&&o.d.__metadata){var s=o.d.__metadata.type.split(".").shift();return o.d.__metadata.uri.split(s).pop();}}}}else{o=r.data;if(o&&o.__metadata){var s=o.__metadata.type.split(".").shift();return o.__metadata.uri.split(s).pop();}}}}return"";}function n(p,l,i){if(l===F.layout.beginColumn.level){sap.ui.getCore().getMessageManager().removeAllMessages();}F.get().setNavigationLayout(p,l,i);I(p);}function N(l){F.get().setNavigationBackLayout(l);var h=H.getInstance().getHash();if(0!==h.indexOf("/")){h="/"+h;}var c=h.split("/");var s=l-c.length;h=h.split("/").slice(0,s).join("/");I(h);}function f(){F.get().setLayout(F.layout.beginColumn.layout);I("");}function b(B){var h=H.getInstance().getHash();if(0!==h.indexOf("/")){h="/"+h;}return-1!==h.indexOf(B);}function d(p){if(U.isEmptyObjectOrString(p)){return{depth:0,paths:[]};}var B=[];if(0===p.indexOf("/")){B=p.split("/").slice(1);}else{B=p.split("/");}B=B.map(function(e){return"/"+e;});return{depth:B.length,paths:B};}function A(){var h=H.getInstance().getHash();var B=d(h);var i=B.depth;n(h,i,true);}function G(D,r){var p,h=H.getInstance().getHash(),s,S;if(0!==h.indexOf("/")){h="/"+h;}if(d(h).depth>1){p=d(h).paths.shift();}else{p=d(h).paths[0];}if(r&&r.headers&&r.headers["location"]){S=r.headers&&r.headers["location"]&&r.headers["location"].split("/").slice(-1).pop();s=p+'/'+S;}else if(r&&r.data&&r.data.__batchResponses&&r.data.__batchResponses[0]&&r.data.__batchResponses[0].__changeResponses&&r.data.__batchResponses[0].__changeResponses[0]&&r.data.__batchResponses[0].__changeResponses[0].headers&&r.data.__batchResponses[0].__changeResponses[0].headers["location"]){S="/"+r.data.__batchResponses[0].__changeResponses[0].headers["location"].split("/").slice(-1).pop();s=_(p,S);}if(!U.isEmptyObjectOrString(S)&&h!==s){return{navPath:s,subPath:S};}return{subPath:S,navPath:""};}return{bindingPaths:d,navigate:n,navigateBack:N,navigateToRoot:f,isBindingPathDisplayed:b,adjustLayout:A,getNavigationPathFromReponse:G};}return g();},true);
